---
title: 实现一个redis客户端
date: 2018-05-16 21:37:18
tags:
---

#### 开发背景
学习一门编程语言，最快捷的方式就是学习了基本语法之后，能够实现一个中型的项目，这样对技术的提升有很大的帮助。针对go语言学习，计划以redis的sdk作为入门练习项目。关于实现这个项目，参考node.js的sdk实现，为了降低开发的难度，先实现系统架构图，要求耦合度低，然后逐个功能模块分解实现。借鉴别人好的设计实现思想，拒绝闭门造车。在架构上力求解耦，模块化。

####  知识准备
在开始完成这个项目之前，需要先了解两方面知识，1. redis通信协议 2. 连接池的实现,在这个项目中，将使用这两个概念来完成该项目。

##### 理解redis通信协议
协议是通信的机制的一种规范，通过这种规范，可以被程序高效的识别。那么redis客户端和服务端的通信协议是怎么规定的，知道了这个协议规范，我们就可以编写程序解析出结果。

- 请求协议
```
*<参数数量> CR LF
$<参数 1 的字节数量> CR LF
<参数 1 的数据> CR LF
...
$<参数 N 的字节数量> CR LF
<参数 N 的数据> CR LF

例如：
*3
$3
SET
$5
mykey
$7
myvalue

"*3\r\n$3\r\nSET\r\n$5\r\nmykey\r\n$7\r\nmyvalue\r\n"
```

以上是客户端，发送请求协议的规范，它是建立在tcp协议之上的。

- 回复协议

作用 | 说明
---|---
状态回复 |（status reply）的第一个字节是 "+"
错误回复 |（error reply）的第一个字节是 "-"
整数回复 |（integer reply）的第一个字节是 ":"
批量回复 |（bulk reply）的第一个字节是 "$"
多条批量回复 |（multi bulk reply）的第一个字节是 "*"

以上对redis的协议做了简单的说明，将以上内容转化为程序语言后，就实现了redis功能的核心模块。

##### 连接池的实现

